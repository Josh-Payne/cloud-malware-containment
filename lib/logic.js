/**
 * Track the greeting message
 * @param {org.example.biznet.WorldGreeting} world_greeting - the message to be processed
 * @transaction
 */

async function worldGreeting(world_greeting) {
    if (world_greeting.client.clientName=="Josh") {
        world_greeting.message.messageText = "hello world!"
        console.log("hello world!") // Where does this go?
    } else {
        world_greeting.message.messageText = "hi world!"
        console.log("hi world!")
    }
    
    let assetRegistry = await getAssetRegistry('org.example.biznet.Message');
    // emit a notification that a trade has occurred
    let greetTheWorld = getFactory().newEvent('org.example.biznet', 'greetTheWorld');
    greetTheWorld.message = world_greeting.message;
    emit(greetTheWorld);
    // persist the state of the commodity
    await assetRegistry.update(world_greeting.message);
}
